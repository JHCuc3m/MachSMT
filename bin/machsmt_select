#!/usr/bin/python3
import argparse,os,sys,pickle
parser = argparse.ArgumentParser()
parser.add_argument('-file', '--file',type=str, required=True)
parser.add_argument('-logic', '--logic',type=str,required=True )
parser.add_argument('-track', '--track',type=str,required=True)
args = parser.parse_args()

if not os.path.exists(args.file):
    print("Could not find file.")
    sys.exit(1)

file = os.path.abspath(args.file)
root = os.path.dirname(os.path.realpath(__file__))[:-3] ##(safely?) navigate to root of smtzilla repo
os.chdir(root)

if not os.path.exists('lib'):
    print("No models found on system.")
    sys.exit(1)

if not os.path.exists('lib/' + args.logic):
    print("Could not find learned model for logic: " + args.logic)
    sys.exit(1)


track = args.track
if track.find('/') != -1:
    track = track.split('/')[-1]

if not os.path.exists('lib/' + args.logic + '/' + track):
    print("No model for track: " + args.track + ', in logic: ' + args.logic)
    sys.exit(1)

lm = pickle.load( open( 'lib/' + args.logic + '/' + track, "rb" ))
print(lm.predict(args.file))
